# Maintainer: onefire <onefire.myself@gmail.com>
pkgname=python-scipy-intel
pkgver=0.12.0
pkgrel=2
pkgdesc="Scipy built with Intel's Math Kernel Library. Optimized for performance. Intel's mkl is not listed as a dependency, but you NEED TO INSTALL IT FIRST (manually or via AUR)"
arch=(x86_64)
url="http://numpy.scipy.org/"
depends=("python" "python-numpy-intel")
makedepends=("swig")
conflicts=('python-scipy')
provides=('python-scipy')
license=('custom')
options=(!strip)
groups=('custom' 'python-intel')

sha512sums=('80c8e137c3ccba86575d4263e144ba2c4684b94b5cd620e200f094c92d4e118ea6a631d27bdb259b0869771dfaeeae68c0fdd37fdd740b9027ee185026e921d4')

source=("http://downloads.sourceforge.net/scipy/scipy-${pkgver}.tar.gz")

build() {
  cd ${srcdir}/scipy-${pkgver}
  python setup.py config --compiler=intelem --fcompiler=intelem build_clib --compiler=intelem --fcompiler=intelem build_ext --compiler=intelem --fcompiler=intelem
}

package() {
  cd ${srcdir}/scipy-${pkgver}
  python setup.py install --prefix=/usr --root=${pkgdir}
  install -m755 -d "${pkgdir}/usr/share/licenses/python-scipy"
  install -m644 LICENSE.txt ${pkgdir}/usr/share/licenses/python-scipy/LICENSE  
  install -m755 -d ${pkgdir}/etc/profile.d
  #Do not need this since that file is created when python-numpy-intel is installed.
  #echo "export LD_LIBRARY_PATH=/opt/intel/composer_xe_${_intelver}/mkl/lib/intel64:/opt/intel/composer_xe_${_intelver}/compiler/lib/intel64:\$LD_LIBRARY_PATH" > ${pkgdir}/etc/profile.d/scipy.sh
}


